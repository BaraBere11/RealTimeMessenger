{"ast":null,"code":"import{useNavigate}from\"react-router\";import{jsx as _jsx}from\"react/jsx-runtime\";const{createContext,useState,useEffect}=require(\"react\");export const AccountContext=createContext();const UserContext=_ref=>{let{children}=_ref;const[user,setUser]=useState({loggedIn:null,token:localStorage.getItem(\"token\")});const navigate=useNavigate();useEffect(()=>{fetch(\"\".concat(process.env.REACT_APP_SERVER_URL,\"/auth/login\"),{credentials:\"include\",headers:{authorization:\"Bearer \".concat(user.token)}}).catch(err=>{setUser({loggedIn:false});return;}).then(r=>{if(!r||!r.ok||r.status>=400){setUser({loggedIn:false});return;}return r.json();}).then(data=>{if(!data){setUser({loggedIn:false});return;}setUser({...data});navigate(\"/home\");});// eslint-disable-next-line react-hooks/exhaustive-deps\n},[]);return/*#__PURE__*/_jsx(AccountContext.Provider,{value:{user,setUser},children:children});};export default UserContext;","map":{"version":3,"names":["useNavigate","jsx","_jsx","createContext","useState","useEffect","require","AccountContext","UserContext","_ref","children","user","setUser","loggedIn","token","localStorage","getItem","navigate","fetch","concat","process","env","REACT_APP_SERVER_URL","credentials","headers","authorization","catch","err","then","r","ok","status","json","data","Provider","value"],"sources":["/Users/apankov/Documents/WEB_Projects/messenger/packages/client/src/components/AccountContext.jsx"],"sourcesContent":["import { useNavigate } from \"react-router\";\n\nconst { createContext, useState, useEffect } = require(\"react\");\n\nexport const AccountContext = createContext();\n\nconst UserContext = ({ children }) => {\n  const [user, setUser] = useState({\n    loggedIn: null,\n    token: localStorage.getItem(\"token\"),\n  });\n  const navigate = useNavigate();\n  useEffect(() => {\n    fetch(`${process.env.REACT_APP_SERVER_URL}/auth/login`, {\n      credentials: \"include\",\n      headers: {\n        authorization: `Bearer ${user.token}`,\n      },\n    })\n      .catch(err => {\n        setUser({ loggedIn: false });\n        return;\n      })\n      .then(r => {\n        if (!r || !r.ok || r.status >= 400) {\n          setUser({ loggedIn: false });\n          return;\n        }\n        return r.json();\n      })\n      .then(data => {\n        if (!data) {\n          setUser({ loggedIn: false });\n          return;\n        }\n        setUser({ ...data });\n        navigate(\"/home\");\n      });\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n  return (\n    <AccountContext.Provider value={{ user, setUser }}>\n      {children}\n    </AccountContext.Provider>\n  );\n};\n\nexport default UserContext;\n"],"mappings":"AAAA,OAASA,WAAW,KAAQ,cAAc,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAE3C,KAAM,CAAEC,aAAa,CAAEC,QAAQ,CAAEC,SAAU,CAAC,CAAGC,OAAO,CAAC,OAAO,CAAC,CAE/D,MAAO,MAAM,CAAAC,cAAc,CAAGJ,aAAa,CAAC,CAAC,CAE7C,KAAM,CAAAK,WAAW,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAC/B,KAAM,CAACE,IAAI,CAAEC,OAAO,CAAC,CAAGR,QAAQ,CAAC,CAC/BS,QAAQ,CAAE,IAAI,CACdC,KAAK,CAAEC,YAAY,CAACC,OAAO,CAAC,OAAO,CACrC,CAAC,CAAC,CACF,KAAM,CAAAC,QAAQ,CAAGjB,WAAW,CAAC,CAAC,CAC9BK,SAAS,CAAC,IAAM,CACda,KAAK,IAAAC,MAAA,CAAIC,OAAO,CAACC,GAAG,CAACC,oBAAoB,gBAAe,CACtDC,WAAW,CAAE,SAAS,CACtBC,OAAO,CAAE,CACPC,aAAa,WAAAN,MAAA,CAAYR,IAAI,CAACG,KAAK,CACrC,CACF,CAAC,CAAC,CACCY,KAAK,CAACC,GAAG,EAAI,CACZf,OAAO,CAAC,CAAEC,QAAQ,CAAE,KAAM,CAAC,CAAC,CAC5B,OACF,CAAC,CAAC,CACDe,IAAI,CAACC,CAAC,EAAI,CACT,GAAI,CAACA,CAAC,EAAI,CAACA,CAAC,CAACC,EAAE,EAAID,CAAC,CAACE,MAAM,EAAI,GAAG,CAAE,CAClCnB,OAAO,CAAC,CAAEC,QAAQ,CAAE,KAAM,CAAC,CAAC,CAC5B,OACF,CACA,MAAO,CAAAgB,CAAC,CAACG,IAAI,CAAC,CAAC,CACjB,CAAC,CAAC,CACDJ,IAAI,CAACK,IAAI,EAAI,CACZ,GAAI,CAACA,IAAI,CAAE,CACTrB,OAAO,CAAC,CAAEC,QAAQ,CAAE,KAAM,CAAC,CAAC,CAC5B,OACF,CACAD,OAAO,CAAC,CAAE,GAAGqB,IAAK,CAAC,CAAC,CACpBhB,QAAQ,CAAC,OAAO,CAAC,CACnB,CAAC,CAAC,CACJ;AACF,CAAC,CAAE,EAAE,CAAC,CACN,mBACEf,IAAA,CAACK,cAAc,CAAC2B,QAAQ,EAACC,KAAK,CAAE,CAAExB,IAAI,CAAEC,OAAQ,CAAE,CAAAF,QAAA,CAC/CA,QAAQ,CACc,CAAC,CAE9B,CAAC,CAED,cAAe,CAAAF,WAAW","ignoreList":[]},"metadata":{},"sourceType":"module"}